---
import PageLayout from "@/layouts/PageLayout.astro";
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";

interface Props {
  name: string;
  slug: string;
  logo: ImageMetadata;
  description: string;
  lumaUrl: string;
  lumaCalendarId: string;
}

const { name, slug, logo, description, lumaUrl, lumaCalendarId } = Astro.props;
const lumaDisplayUrl = lumaUrl.replace("https://", "");
---

<PageLayout
  title={`${name} | events | oscarama`}
  description={description}
  ogUrl={`https://oscarama.dev/events/${slug}`}
>
  <a
    href="/events"
    class="text-sm text-white/50 hover:text-white/70 transition-colors mb-4"
    onclick={`window.posthog?.capture('event_back_clicked', { from: '${slug}' })`}
  >
    &larr; all events
  </a>

  <div class="flex flex-row items-center gap-4">
    <Image src={logo} alt={name} class="w-16 h-16 rounded-sm object-contain" />
    <div>
      <h1 class="text-3xl font-bold">{name}</h1>
      <a
        href={lumaUrl}
        target="_blank"
        rel="noopener noreferrer"
        class="text-sm text-[#E56717] hover:underline"
        onclick={`window.posthog?.capture('event_luma_link_clicked', { series: '${slug}', location: 'header' })`}
      >
        {lumaDisplayUrl}
      </a>
    </div>
  </div>

  <p class="text-sm text-white/70 mt-6">
    {description}
  </p>

  <h2 class="text-xl mt-12 mb-6">upcoming</h2>

  <div class="w-full border border-white/20 rounded-sm overflow-hidden bg-[#1a1a1a] z-10">
    <iframe
      src={`https://luma.com/embed/calendar/${lumaCalendarId}/events`}
      width="100%"
      height="600"
      frameborder="0"
      style="border: none; background: transparent;"
      allowfullscreen
      aria-hidden="false"
      tabindex="0"
    >
    </iframe>
  </div>

  <p class="text-sm text-white/50 mt-4">
    View all events and RSVP on{" "}
    <a
      href={lumaUrl}
      target="_blank"
      rel="noopener noreferrer"
      class="text-[#E56717] hover:underline"
      onclick={`window.posthog?.capture('event_luma_link_clicked', { series: '${slug}', location: 'footer' })`}
    >
      Luma
    </a>
  </p>
</PageLayout>
